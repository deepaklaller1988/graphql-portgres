"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var crypto_1 = require("crypto");
/**
 * Encrypt data.
 */
function encryptData(data, options) {
    var iv = options.iv
        ? Buffer.from(options.iv, 'hex')
        : crypto_1.randomBytes(options.ivLength);
    var cipher = crypto_1.createCipheriv(options.algorithm, Buffer.from(options.key, 'hex'), iv);
    var start = cipher.update(data);
    var final = cipher.final();
    return Buffer.concat([iv, start, final]);
}
exports.encryptData = encryptData;
/**
 * Decrypt data.
 */
function decryptData(data, options) {
    var iv = data.slice(0, options.ivLength);
    var decipher = crypto_1.createDecipheriv(options.algorithm, Buffer.from(options.key, 'hex'), iv);
    var start = decipher.update(data.slice(options.ivLength));
    var final = decipher.final();
    return Buffer.concat([start, final]);
}
exports.decryptData = decryptData;
//# sourceMappingURL=crypto.js.map